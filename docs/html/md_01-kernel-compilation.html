<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Linux Driver Development Manual: Linux Kernel Compilation</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Linux Driver Development Manual
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">Comprehensive guide to Linux kernel and device driver development</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Linux Kernel Compilation </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="autotoc_md1"></a>
Overview</h1>
<p>Kernel compilation is the process of building the Linux kernel from source code. This chapter covers downloading, configuring, and compiling the Linux kernel.</p>
<h1><a class="anchor" id="autotoc_md2"></a>
Prerequisites</h1>
<ul>
<li>Build tools: gcc, make, binutils</li>
<li>Development libraries</li>
<li>Sufficient disk space (15-20 GB)</li>
<li>Root or sudo access</li>
</ul>
<h1><a class="anchor" id="autotoc_md3"></a>
Installing Build Dependencies</h1>
<h2><a class="anchor" id="autotoc_md4"></a>
Debian/Ubuntu</h2>
<div class="fragment"><div class="line">sudo apt-get update</div>
<div class="line">sudo apt-get install build-essential libncurses-dev bison flex libssl-dev libelf-dev</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md5"></a>
RHEL/CentOS/Fedora</h2>
<div class="fragment"><div class="line">sudo yum groupinstall &quot;Development Tools&quot;</div>
<div class="line">sudo yum install ncurses-devel bison flex elfutils-libelf-devel openssl-devel</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md6"></a>
Downloading Kernel Source</h1>
<h2><a class="anchor" id="autotoc_md7"></a>
Method 1: Using Git</h2>
<div class="fragment"><div class="line">git clone https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git</div>
<div class="line">cd linux</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md8"></a>
Method 2: Download Tarball</h2>
<div class="fragment"><div class="line">wget https://cdn.kernel.org/pub/linux/kernel/v6.x/linux-6.x.tar.xz</div>
<div class="line">tar -xf linux-6.x.tar.xz</div>
<div class="line">cd linux-6.x</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md9"></a>
Kernel Configuration</h1>
<h2><a class="anchor" id="autotoc_md10"></a>
Using Existing Configuration</h2>
<div class="fragment"><div class="line"># Copy current system config</div>
<div class="line">cp /boot/config-$(uname -r) .config</div>
<div class="line">make oldconfig</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md11"></a>
Configuration Methods</h2>
<h3><a class="anchor" id="autotoc_md12"></a>
1. menuconfig (Text-based UI)</h3>
<div class="fragment"><div class="line">make menuconfig</div>
</div><!-- fragment --><ul>
<li>Navigate with arrow keys</li>
<li>Space to select/deselect</li>
<li>'/' to search</li>
<li>Save and exit</li>
</ul>
<h3><a class="anchor" id="autotoc_md13"></a>
2. xconfig (Qt-based GUI)</h3>
<div class="fragment"><div class="line">make xconfig</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md14"></a>
3. gconfig (GTK-based GUI)</h3>
<div class="fragment"><div class="line">make gconfig</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md15"></a>
4. Default Configuration</h3>
<div class="fragment"><div class="line">make defconfig        # Default config</div>
<div class="line">make allmodconfig     # All modules</div>
<div class="line">make allyesconfig     # Everything built-in</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md16"></a>
Important Configuration Options</h1>
<h2><a class="anchor" id="autotoc_md17"></a>
General Setup</h2>
<ul>
<li><code>CONFIG_LOCALVERSION</code>: Custom kernel version string</li>
<li><code>CONFIG_DEFAULT_HOSTNAME</code>: Default hostname</li>
</ul>
<h2><a class="anchor" id="autotoc_md18"></a>
Processor Type and Features</h2>
<ul>
<li><code>CONFIG_SMP</code>: Symmetric multi-processing support</li>
<li><code>CONFIG_NR_CPUS</code>: Maximum number of CPUs</li>
</ul>
<h2><a class="anchor" id="autotoc_md19"></a>
Device Drivers</h2>
<ul>
<li>Enable drivers for your hardware</li>
<li>Built-in (Y) vs Module (M)</li>
</ul>
<h2><a class="anchor" id="autotoc_md20"></a>
File Systems</h2>
<ul>
<li>Enable required filesystem support</li>
<li>ext4, btrfs, xfs, etc.</li>
</ul>
<h1><a class="anchor" id="autotoc_md21"></a>
Compiling the Kernel</h1>
<h2><a class="anchor" id="autotoc_md22"></a>
Determine Number of CPU Cores</h2>
<div class="fragment"><div class="line">nproc</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md23"></a>
Compile Kernel</h2>
<div class="fragment"><div class="line"># Clean previous builds (optional)</div>
<div class="line">make clean</div>
<div class="line">make mrproper  # Complete clean</div>
<div class="line"> </div>
<div class="line"># Compile (use -j for parallel jobs)</div>
<div class="line">make -j$(nproc)</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md24"></a>
Compile Modules</h2>
<div class="fragment"><div class="line">make modules -j$(nproc)</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md25"></a>
Compilation Time</h2>
<ul>
<li>Depends on hardware and configuration</li>
<li>Typically 30 minutes to 2 hours</li>
</ul>
<h1><a class="anchor" id="autotoc_md26"></a>
Installing the Kernel</h1>
<h2><a class="anchor" id="autotoc_md27"></a>
Install Modules</h2>
<div class="fragment"><div class="line">sudo make modules_install</div>
</div><!-- fragment --><ul>
<li>Installs to <code>/lib/modules/&lt;kernel-version&gt;/</code></li>
</ul>
<h2><a class="anchor" id="autotoc_md28"></a>
Install Kernel</h2>
<div class="fragment"><div class="line">sudo make install</div>
</div><!-- fragment --><p>This command:</p><ol type="1">
<li>Copies kernel to <code>/boot/vmlinuz-&lt;version&gt;</code></li>
<li>Copies System.map to <code>/boot/</code></li>
<li>Creates initramfs</li>
<li>Updates bootloader configuration</li>
</ol>
<h2><a class="anchor" id="autotoc_md29"></a>
Manual Installation</h2>
<h3><a class="anchor" id="autotoc_md30"></a>
Copy Kernel Image</h3>
<div class="fragment"><div class="line">sudo cp arch/x86/boot/bzImage /boot/vmlinuz-&lt;version&gt;</div>
<div class="line">sudo cp System.map /boot/System.map-&lt;version&gt;</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md31"></a>
Generate initramfs</h3>
<div class="fragment"><div class="line"># Debian/Ubuntu</div>
<div class="line">sudo update-initramfs -c -k &lt;version&gt;</div>
<div class="line"> </div>
<div class="line"># RHEL/CentOS</div>
<div class="line">sudo dracut /boot/initramfs-&lt;version&gt;.img &lt;version&gt;</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md32"></a>
Update Bootloader</h3>
<p><b>GRUB2:</b> </p><div class="fragment"><div class="line">sudo update-grub           # Debian/Ubuntu</div>
<div class="line">sudo grub2-mkconfig -o /boot/grub2/grub.cfg  # RHEL/CentOS</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md33"></a>
Booting the New Kernel</h1>
<h2><a class="anchor" id="autotoc_md34"></a>
Reboot System</h2>
<div class="fragment"><div class="line">sudo reboot</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md35"></a>
Select Kernel at Boot</h2>
<ul>
<li>GRUB menu appears during boot</li>
<li>Select your new kernel version</li>
<li>Press Enter</li>
</ul>
<h2><a class="anchor" id="autotoc_md36"></a>
Verify Kernel Version</h2>
<div class="fragment"><div class="line">uname -r</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md37"></a>
Kernel Configuration Files</h1>
<h2><a class="anchor" id="autotoc_md38"></a>
Important Files</h2>
<ul>
<li><code>.config</code>: Current kernel configuration</li>
<li><code>System.map</code>: Kernel symbol table</li>
<li><code>vmlinux</code>: Uncompressed kernel (ELF)</li>
<li><code>arch/x86/boot/bzImage</code>: Compressed bootable kernel</li>
</ul>
<h1><a class="anchor" id="autotoc_md39"></a>
Cross-Compilation</h1>
<h2><a class="anchor" id="autotoc_md40"></a>
For ARM Architecture</h2>
<div class="fragment"><div class="line"># Install cross-compiler</div>
<div class="line">sudo apt-get install gcc-arm-linux-gnueabihf</div>
<div class="line"> </div>
<div class="line"># Set architecture and cross-compiler</div>
<div class="line">export ARCH=arm</div>
<div class="line">export CROSS_COMPILE=arm-linux-gnueabihf-</div>
<div class="line"> </div>
<div class="line"># Configure and compile</div>
<div class="line">make defconfig</div>
<div class="line">make -j$(nproc)</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md41"></a>
For ARM64</h2>
<div class="fragment"><div class="line">export ARCH=arm64</div>
<div class="line">export CROSS_COMPILE=aarch64-linux-gnu-</div>
<div class="line">make defconfig</div>
<div class="line">make -j$(nproc)</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md42"></a>
Kernel Build Artifacts</h1>
<div class="fragment"><div class="line">vmlinux              # Uncompressed kernel</div>
<div class="line">arch/*/boot/bzImage  # Compressed bootable image</div>
<div class="line">System.map           # Symbol table</div>
<div class="line">.config              # Configuration file</div>
<div class="line">modules              # Loadable kernel modules</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md43"></a>
Troubleshooting</h1>
<h2><a class="anchor" id="autotoc_md44"></a>
Compilation Errors</h2>
<p><b>Missing dependencies:</b> </p><div class="fragment"><div class="line"># Install missing packages based on error messages</div>
<div class="line">sudo apt-get install &lt;package-name&gt;</div>
</div><!-- fragment --><p><b>Out of memory:</b> </p><div class="fragment"><div class="line"># Reduce parallel jobs</div>
<div class="line">make -j2</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md45"></a>
Boot Issues</h2>
<p><b>Kernel panic:</b></p><ul>
<li>Boot into old kernel from GRUB menu</li>
<li>Check kernel logs: <code>dmesg</code></li>
<li>Verify configuration</li>
</ul>
<p><b>Missing modules:</b> </p><div class="fragment"><div class="line"># Reinstall modules</div>
<div class="line">sudo make modules_install</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md46"></a>
Cleaning Build Files</h1>
<div class="fragment"><div class="line">make clean          # Remove most generated files</div>
<div class="line">make mrproper       # Remove all generated files including .config</div>
<div class="line">make distclean      # mrproper + remove editor backup files</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md47"></a>
Kernel Versioning</h1>
<h2><a class="anchor" id="autotoc_md48"></a>
Version Format</h2>
<div class="fragment"><div class="line">Major.Minor.Patch[-ExtraVersion]</div>
<div class="line">Example: 6.1.25-custom</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md49"></a>
Set Custom Version</h2>
<div class="fragment"><div class="line"># In .config or via menuconfig</div>
<div class="line">CONFIG_LOCALVERSION=&quot;-custom&quot;</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md50"></a>
Best Practices</h1>
<ol type="1">
<li><b>Backup current kernel</b> before installing new one</li>
<li><b>Keep old kernel</b> in bootloader for fallback</li>
<li><b>Test in VM</b> before production systems</li>
<li><b>Document changes</b> to configuration</li>
<li><b>Use version control</b> for custom patches</li>
<li><b>Enable only needed features</b> for smaller, faster kernel</li>
</ol>
<h1><a class="anchor" id="autotoc_md51"></a>
Useful Commands</h1>
<div class="fragment"><div class="line"># Show kernel build version</div>
<div class="line">cat /proc/version</div>
<div class="line"> </div>
<div class="line"># Show loaded modules</div>
<div class="line">lsmod</div>
<div class="line"> </div>
<div class="line"># Show kernel messages</div>
<div class="line">dmesg</div>
<div class="line"> </div>
<div class="line"># Show kernel configuration</div>
<div class="line">cat /proc/config.gz | gunzip</div>
<div class="line"> </div>
<div class="line"># Module information</div>
<div class="line">modinfo &lt;module_name&gt;</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md52"></a>
Next Steps</h1>
<p>After successfully compiling and booting your custom kernel, proceed to <a class="el" href="md_02-embedded-linux.html">Embedded Linux</a> to learn about kernel configuration for embedded systems. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Feb 13 2026 16:02:32 for Linux Driver Development Manual by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
